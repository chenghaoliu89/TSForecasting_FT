Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='exchange', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/exchange_TCN_bstmodel.pth', model_type='TCN', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 143688
Length of dataset: 4492
Length of dataset: 1518
Length of dataset: 1518
epoch = 1 , trn loss = 0.047537 , trn err = 0.217938 , val loss = 0.055015 , val err = 0.229668 , tst loss = 0.059897 , tst err = 0.254835
epoch = 2 , trn loss = 0.003204 , trn err = 0.056576 , val loss = 0.041213 , val err = 0.198782 , tst loss = 0.039256 , tst err = 0.206304
epoch = 3 , trn loss = 0.002095 , trn err = 0.045757 , val loss = 0.030814 , val err = 0.171885 , tst loss = 0.029723 , tst err = 0.179516
epoch = 4 , trn loss = 0.001306 , trn err = 0.036122 , val loss = 0.025248 , val err = 0.155587 , tst loss = 0.025401 , tst err = 0.165951
epoch = 5 , trn loss = 0.000892 , trn err = 0.029855 , val loss = 0.017543 , val err = 0.129691 , tst loss = 0.018194 , tst err = 0.140450
epoch = 6 , trn loss = 0.000627 , trn err = 0.025019 , val loss = 0.015527 , val err = 0.122015 , tst loss = 0.015769 , tst err = 0.130753
epoch = 7 , trn loss = 0.000454 , trn err = 0.021291 , val loss = 0.014546 , val err = 0.118094 , tst loss = 0.014179 , tst err = 0.123988
epoch = 8 , trn loss = 0.000366 , trn err = 0.019113 , val loss = 0.013697 , val err = 0.114596 , tst loss = 0.013679 , tst err = 0.121783
epoch = 9 , trn loss = 0.000330 , trn err = 0.018158 , val loss = 0.015081 , val err = 0.120246 , tst loss = 0.015061 , tst err = 0.127788
epoch = 10 , trn loss = 0.000310 , trn err = 0.017589 , val loss = 0.014245 , val err = 0.116867 , tst loss = 0.014223 , tst err = 0.124180
epoch = 11 , trn loss = 0.000279 , trn err = 0.016698 , val loss = 0.018159 , val err = 0.131950 , tst loss = 0.016931 , tst err = 0.135487
epoch = 12 , trn loss = 0.000371 , trn err = 0.019250 , val loss = 0.013295 , val err = 0.112903 , tst loss = 0.013880 , tst err = 0.122674
epoch = 13 , trn loss = 0.000249 , trn err = 0.015767 , val loss = 0.013775 , val err = 0.114923 , tst loss = 0.014406 , tst err = 0.124979
epoch = 14 , trn loss = 0.000244 , trn err = 0.015602 , val loss = 0.012200 , val err = 0.108154 , tst loss = 0.013070 , tst err = 0.119040
epoch = 15 , trn loss = 0.000241 , trn err = 0.015505 , val loss = 0.012766 , val err = 0.110633 , tst loss = 0.013654 , tst err = 0.121671
epoch = 16 , trn loss = 0.000253 , trn err = 0.015906 , val loss = 0.012055 , val err = 0.107511 , tst loss = 0.012944 , tst err = 0.118467
epoch = 17 , trn loss = 0.000243 , trn err = 0.015579 , val loss = 0.010285 , val err = 0.099304 , tst loss = 0.011503 , tst err = 0.111676
epoch = 18 , trn loss = 0.000289 , trn err = 0.016990 , val loss = 0.010219 , val err = 0.098985 , tst loss = 0.011923 , tst err = 0.113698
epoch = 19 , trn loss = 0.000246 , trn err = 0.015667 , val loss = 0.012220 , val err = 0.108243 , tst loss = 0.013708 , tst err = 0.121912
epoch = 20 , trn loss = 0.000218 , trn err = 0.014768 , val loss = 0.011590 , val err = 0.105414 , tst loss = 0.013391 , tst err = 0.120494
epoch = 21 , trn loss = 0.000199 , trn err = 0.014101 , val loss = 0.010362 , val err = 0.099675 , tst loss = 0.012075 , tst err = 0.114421
epoch = 22 , trn loss = 0.000214 , trn err = 0.014629 , val loss = 0.010154 , val err = 0.098668 , tst loss = 0.011902 , tst err = 0.113597
epoch = 23 , trn loss = 0.000240 , trn err = 0.015477 , val loss = 0.010723 , val err = 0.101398 , tst loss = 0.012969 , tst err = 0.118578
epoch = 24 , trn loss = 0.000212 , trn err = 0.014554 , val loss = 0.009578 , val err = 0.095827 , tst loss = 0.011530 , tst err = 0.111807
epoch = 25 , trn loss = 0.000206 , trn err = 0.014355 , val loss = 0.010336 , val err = 0.099550 , tst loss = 0.012274 , tst err = 0.115358
epoch = 26 , trn loss = 0.000202 , trn err = 0.014219 , val loss = 0.010755 , val err = 0.101545 , tst loss = 0.012455 , tst err = 0.116204
epoch = 27 , trn loss = 0.000192 , trn err = 0.013838 , val loss = 0.011297 , val err = 0.104076 , tst loss = 0.013606 , tst err = 0.121457
epoch = 28 , trn loss = 0.000226 , trn err = 0.015029 , val loss = 0.010102 , val err = 0.098417 , tst loss = 0.012106 , tst err = 0.114565
epoch = 29 , trn loss = 0.000228 , trn err = 0.015081 , val loss = 0.010881 , val err = 0.102142 , tst loss = 0.012982 , tst err = 0.118639
epoch = 30 , trn loss = 0.000217 , trn err = 0.014709 , val loss = 0.009286 , val err = 0.094357 , tst loss = 0.011487 , tst err = 0.111600
epoch = 31 , trn loss = 0.000223 , trn err = 0.014917 , val loss = 0.010495 , val err = 0.100311 , tst loss = 0.012457 , tst err = 0.116215
epoch = 32 , trn loss = 0.000212 , trn err = 0.014571 , val loss = 0.013061 , val err = 0.111906 , tst loss = 0.015336 , tst err = 0.128946
epoch = 33 , trn loss = 0.000242 , trn err = 0.015538 , val loss = 0.010017 , val err = 0.098000 , tst loss = 0.012370 , tst err = 0.115807
epoch = 34 , trn loss = 0.000201 , trn err = 0.014171 , val loss = 0.009809 , val err = 0.096977 , tst loss = 0.011834 , tst err = 0.113270
epoch = 35 , trn loss = 0.000192 , trn err = 0.013866 , val loss = 0.008985 , val err = 0.092814 , tst loss = 0.010649 , tst err = 0.107449
epoch = 36 , trn loss = 0.000238 , trn err = 0.015416 , val loss = 0.010554 , val err = 0.100593 , tst loss = 0.012914 , tst err = 0.118327
epoch = 37 , trn loss = 0.000182 , trn err = 0.013497 , val loss = 0.010137 , val err = 0.098587 , tst loss = 0.012246 , tst err = 0.115229
epoch = 38 , trn loss = 0.000228 , trn err = 0.015105 , val loss = 0.008819 , val err = 0.091954 , tst loss = 0.010980 , tst err = 0.109109
epoch = 39 , trn loss = 0.000185 , trn err = 0.013598 , val loss = 0.007885 , val err = 0.086947 , tst loss = 0.009998 , tst err = 0.104116
epoch = 40 , trn loss = 0.000259 , trn err = 0.016092 , val loss = 0.008703 , val err = 0.091348 , tst loss = 0.010950 , tst err = 0.108961
epoch = 41 , trn loss = 0.000194 , trn err = 0.013912 , val loss = 0.009973 , val err = 0.097788 , tst loss = 0.012221 , tst err = 0.115107
epoch = 42 , trn loss = 0.000204 , trn err = 0.014262 , val loss = 0.009423 , val err = 0.095053 , tst loss = 0.011733 , tst err = 0.112789
epoch = 43 , trn loss = 0.000203 , trn err = 0.014255 , val loss = 0.008755 , val err = 0.091622 , tst loss = 0.010881 , tst err = 0.108617
epoch = 44 , trn loss = 0.000200 , trn err = 0.014128 , val loss = 0.008197 , val err = 0.088650 , tst loss = 0.010447 , tst err = 0.106426
epoch = 45 , trn loss = 0.000209 , trn err = 0.014443 , val loss = 0.009248 , val err = 0.094165 , tst loss = 0.011473 , tst err = 0.111531
epoch = 46 , trn loss = 0.000194 , trn err = 0.013910 , val loss = 0.009924 , val err = 0.097545 , tst loss = 0.012203 , tst err = 0.115025
epoch = 47 , trn loss = 0.000194 , trn err = 0.013934 , val loss = 0.009029 , val err = 0.093041 , tst loss = 0.011194 , tst err = 0.110165
epoch = 48 , trn loss = 0.000179 , trn err = 0.013369 , val loss = 0.009184 , val err = 0.093840 , tst loss = 0.011387 , tst err = 0.111112
epoch = 49 , trn loss = 0.000188 , trn err = 0.013712 , val loss = 0.009828 , val err = 0.097071 , tst loss = 0.012055 , tst err = 0.114326
epoch = 50 , trn loss = 0.000251 , trn err = 0.015833 , val loss = 0.009139 , val err = 0.093606 , tst loss = 0.011526 , tst err = 0.111787
epoch = 51 , trn loss = 0.000223 , trn err = 0.014919 , val loss = 0.009616 , val err = 0.096018 , tst loss = 0.012185 , tst err = 0.114942
epoch = 52 , trn loss = 0.000180 , trn err = 0.013400 , val loss = 0.008308 , val err = 0.089251 , tst loss = 0.010675 , tst err = 0.107583
epoch = 53 , trn loss = 0.000179 , trn err = 0.013381 , val loss = 0.007430 , val err = 0.084402 , tst loss = 0.009542 , tst err = 0.101714
epoch = 54 , trn loss = 0.000179 , trn err = 0.013387 , val loss = 0.008466 , val err = 0.090096 , tst loss = 0.010771 , tst err = 0.108064
epoch = 55 , trn loss = 0.000179 , trn err = 0.013368 , val loss = 0.008594 , val err = 0.090773 , tst loss = 0.010932 , tst err = 0.108867
epoch = 56 , trn loss = 0.000198 , trn err = 0.014068 , val loss = 0.008339 , val err = 0.089415 , tst loss = 0.010478 , tst err = 0.106584
epoch = 57 , trn loss = 0.000197 , trn err = 0.014016 , val loss = 0.008543 , val err = 0.090506 , tst loss = 0.010806 , tst err = 0.108240
epoch = 58 , trn loss = 0.000197 , trn err = 0.014020 , val loss = 0.007759 , val err = 0.086249 , tst loss = 0.009932 , tst err = 0.103773
epoch = 59 , trn loss = 0.000196 , trn err = 0.013997 , val loss = 0.008438 , val err = 0.089945 , tst loss = 0.010630 , tst err = 0.107353
epoch = 60 , trn loss = 0.000196 , trn err = 0.013994 , val loss = 0.008361 , val err = 0.089536 , tst loss = 0.010755 , tst err = 0.107984
epoch = 61 , trn loss = 0.000164 , trn err = 0.012820 , val loss = 0.008555 , val err = 0.090570 , tst loss = 0.010645 , tst err = 0.107429
epoch = 62 , trn loss = 0.000173 , trn err = 0.013128 , val loss = 0.007246 , val err = 0.083350 , tst loss = 0.009367 , tst err = 0.100775
epoch = 63 , trn loss = 0.000190 , trn err = 0.013785 , val loss = 0.006597 , val err = 0.079533 , tst loss = 0.008908 , tst err = 0.098274
epoch = 64 , trn loss = 0.000185 , trn err = 0.013603 , val loss = 0.007024 , val err = 0.082062 , tst loss = 0.009380 , tst err = 0.100845
epoch = 65 , trn loss = 0.000179 , trn err = 0.013373 , val loss = 0.007855 , val err = 0.086783 , tst loss = 0.010260 , tst err = 0.105473
epoch = 66 , trn loss = 0.000172 , trn err = 0.013127 , val loss = 0.008608 , val err = 0.090846 , tst loss = 0.010931 , tst err = 0.108863
epoch = 67 , trn loss = 0.000159 , trn err = 0.012604 , val loss = 0.008126 , val err = 0.088270 , tst loss = 0.010529 , tst err = 0.106846
epoch = 68 , trn loss = 0.000192 , trn err = 0.013856 , val loss = 0.008050 , val err = 0.087856 , tst loss = 0.010500 , tst err = 0.106696
epoch = 69 , trn loss = 0.000179 , trn err = 0.013371 , val loss = 0.008579 , val err = 0.090694 , tst loss = 0.010771 , tst err = 0.108066
epoch = 70 , trn loss = 0.000183 , trn err = 0.013520 , val loss = 0.008050 , val err = 0.087852 , tst loss = 0.010385 , tst err = 0.106112
epoch = 71 , trn loss = 0.000190 , trn err = 0.013778 , val loss = 0.007099 , val err = 0.082502 , tst loss = 0.009365 , tst err = 0.100766
epoch = 72 , trn loss = 0.000189 , trn err = 0.013735 , val loss = 0.008178 , val err = 0.088551 , tst loss = 0.010659 , tst err = 0.107502
epoch = 73 , trn loss = 0.000198 , trn err = 0.014048 , val loss = 0.007790 , val err = 0.086422 , tst loss = 0.010129 , tst err = 0.104794
epoch = 74 , trn loss = 0.000155 , trn err = 0.012444 , val loss = 0.009077 , val err = 0.093291 , tst loss = 0.011636 , tst err = 0.112320
epoch = 75 , trn loss = 0.000175 , trn err = 0.013219 , val loss = 0.007276 , val err = 0.083523 , tst loss = 0.009817 , tst err = 0.103171
epoch = 76 , trn loss = 0.000189 , trn err = 0.013749 , val loss = 0.006904 , val err = 0.081363 , tst loss = 0.009240 , tst err = 0.100091
epoch = 77 , trn loss = 0.000222 , trn err = 0.014892 , val loss = 0.007911 , val err = 0.087090 , tst loss = 0.010742 , tst err = 0.107921
epoch = 78 , trn loss = 0.000152 , trn err = 0.012329 , val loss = 0.007500 , val err = 0.084802 , tst loss = 0.010065 , tst err = 0.104463
epoch = 79 , trn loss = 0.000171 , trn err = 0.013074 , val loss = 0.007474 , val err = 0.084651 , tst loss = 0.010076 , tst err = 0.104521
epoch = 80 , trn loss = 0.000169 , trn err = 0.013012 , val loss = 0.007843 , val err = 0.086717 , tst loss = 0.010451 , tst err = 0.106448
epoch = 81 , trn loss = 0.000194 , trn err = 0.013921 , val loss = 0.006825 , val err = 0.080892 , tst loss = 0.009229 , tst err = 0.100031
epoch = 82 , trn loss = 0.000183 , trn err = 0.013528 , val loss = 0.007128 , val err = 0.082671 , tst loss = 0.009771 , tst err = 0.102926
epoch = 83 , trn loss = 0.000163 , trn err = 0.012772 , val loss = 0.006913 , val err = 0.081411 , tst loss = 0.009743 , tst err = 0.102778
epoch = 84 , trn loss = 0.000166 , trn err = 0.012892 , val loss = 0.007591 , val err = 0.085313 , tst loss = 0.010363 , tst err = 0.105999
epoch = 85 , trn loss = 0.000159 , trn err = 0.012607 , val loss = 0.006948 , val err = 0.081618 , tst loss = 0.009679 , tst err = 0.102441
epoch = 86 , trn loss = 0.000181 , trn err = 0.013437 , val loss = 0.007609 , val err = 0.085415 , tst loss = 0.010537 , tst err = 0.106885
epoch = 87 , trn loss = 0.000171 , trn err = 0.013090 , val loss = 0.007346 , val err = 0.083922 , tst loss = 0.009954 , tst err = 0.103885
epoch = 88 , trn loss = 0.000199 , trn err = 0.014106 , val loss = 0.007042 , val err = 0.082167 , tst loss = 0.009811 , tst err = 0.103137
