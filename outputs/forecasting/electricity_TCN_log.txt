Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='electricity', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/electricity_TCN_bstmodel.pth', model_type='TCN', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 224129
Length of dataset: 15722
Length of dataset: 5261
Length of dataset: 5261
epoch = 1 , trn loss = 0.051066 , trn err = 0.225685 , val loss = 0.009317 , val err = 0.139872 , tst loss = 0.017829 , tst err = 0.125824
epoch = 2 , trn loss = 0.011161 , trn err = 0.105509 , val loss = 0.005766 , val err = 0.110032 , tst loss = 0.009492 , tst err = 0.091807
epoch = 3 , trn loss = 0.010152 , trn err = 0.100625 , val loss = 0.005553 , val err = 0.107983 , tst loss = 0.010559 , tst err = 0.096829
epoch = 4 , trn loss = 0.008506 , trn err = 0.092108 , val loss = 0.006596 , val err = 0.117687 , tst loss = 0.011646 , tst err = 0.101693
epoch = 5 , trn loss = 0.008250 , trn err = 0.090712 , val loss = 0.005811 , val err = 0.110464 , tst loss = 0.009004 , tst err = 0.089416
epoch = 6 , trn loss = 0.008248 , trn err = 0.090699 , val loss = 0.006022 , val err = 0.112447 , tst loss = 0.011724 , tst err = 0.102036
epoch = 7 , trn loss = 0.007588 , trn err = 0.086998 , val loss = 0.006970 , val err = 0.120975 , tst loss = 0.014813 , tst err = 0.114691
epoch = 8 , trn loss = 0.007791 , trn err = 0.088152 , val loss = 0.005014 , val err = 0.102614 , tst loss = 0.008179 , tst err = 0.085221
epoch = 9 , trn loss = 0.007386 , trn err = 0.085830 , val loss = 0.005151 , val err = 0.103998 , tst loss = 0.007793 , tst err = 0.083185
epoch = 10 , trn loss = 0.006960 , trn err = 0.083321 , val loss = 0.006526 , val err = 0.117066 , tst loss = 0.011849 , tst err = 0.102576
epoch = 11 , trn loss = 0.007081 , trn err = 0.084039 , val loss = 0.005117 , val err = 0.103656 , tst loss = 0.008289 , tst err = 0.085793
epoch = 12 , trn loss = 0.006623 , trn err = 0.081279 , val loss = 0.004811 , val err = 0.100506 , tst loss = 0.006946 , tst err = 0.078535
epoch = 13 , trn loss = 0.006434 , trn err = 0.080106 , val loss = 0.005740 , val err = 0.109788 , tst loss = 0.010596 , tst err = 0.097001
epoch = 14 , trn loss = 0.006602 , trn err = 0.081145 , val loss = 0.005566 , val err = 0.108106 , tst loss = 0.008565 , tst err = 0.087211
epoch = 15 , trn loss = 0.006413 , trn err = 0.079979 , val loss = 0.006018 , val err = 0.112412 , tst loss = 0.009152 , tst err = 0.090147
epoch = 16 , trn loss = 0.006088 , trn err = 0.077924 , val loss = 0.005208 , val err = 0.104575 , tst loss = 0.007556 , tst err = 0.081914
epoch = 17 , trn loss = 0.006109 , trn err = 0.078057 , val loss = 0.006280 , val err = 0.114832 , tst loss = 0.012421 , tst err = 0.105024
epoch = 18 , trn loss = 0.006141 , trn err = 0.078265 , val loss = 0.005596 , val err = 0.108401 , tst loss = 0.009760 , tst err = 0.093094
epoch = 19 , trn loss = 0.005754 , trn err = 0.075759 , val loss = 0.005458 , val err = 0.107060 , tst loss = 0.008939 , tst err = 0.089096
epoch = 20 , trn loss = 0.005791 , trn err = 0.076001 , val loss = 0.005275 , val err = 0.105245 , tst loss = 0.008676 , tst err = 0.087776
epoch = 21 , trn loss = 0.005514 , trn err = 0.074158 , val loss = 0.005018 , val err = 0.102653 , tst loss = 0.008539 , tst err = 0.087079
epoch = 22 , trn loss = 0.005673 , trn err = 0.075223 , val loss = 0.005055 , val err = 0.103027 , tst loss = 0.007261 , tst err = 0.080295
epoch = 23 , trn loss = 0.005638 , trn err = 0.074989 , val loss = 0.004719 , val err = 0.099542 , tst loss = 0.007714 , tst err = 0.082767
epoch = 24 , trn loss = 0.005802 , trn err = 0.076070 , val loss = 0.005168 , val err = 0.104168 , tst loss = 0.008646 , tst err = 0.087624
epoch = 25 , trn loss = 0.005478 , trn err = 0.073921 , val loss = 0.004826 , val err = 0.100664 , tst loss = 0.008967 , tst err = 0.089236
epoch = 26 , trn loss = 0.005337 , trn err = 0.072958 , val loss = 0.005193 , val err = 0.104422 , tst loss = 0.007882 , tst err = 0.083663
epoch = 27 , trn loss = 0.005327 , trn err = 0.072893 , val loss = 0.005102 , val err = 0.103505 , tst loss = 0.007607 , tst err = 0.082188
epoch = 28 , trn loss = 0.005322 , trn err = 0.072857 , val loss = 0.004691 , val err = 0.099251 , tst loss = 0.007410 , tst err = 0.081116
epoch = 29 , trn loss = 0.005150 , trn err = 0.071673 , val loss = 0.005160 , val err = 0.104096 , tst loss = 0.006437 , tst err = 0.075602
epoch = 30 , trn loss = 0.005115 , trn err = 0.071430 , val loss = 0.004740 , val err = 0.099765 , tst loss = 0.008527 , tst err = 0.087018
epoch = 31 , trn loss = 0.004998 , trn err = 0.070608 , val loss = 0.004635 , val err = 0.098652 , tst loss = 0.007544 , tst err = 0.081848
epoch = 32 , trn loss = 0.005094 , trn err = 0.071278 , val loss = 0.005301 , val err = 0.105505 , tst loss = 0.010174 , tst err = 0.095052
epoch = 33 , trn loss = 0.004922 , trn err = 0.070066 , val loss = 0.004569 , val err = 0.097951 , tst loss = 0.006791 , tst err = 0.077658
epoch = 34 , trn loss = 0.004977 , trn err = 0.070455 , val loss = 0.004710 , val err = 0.099448 , tst loss = 0.006576 , tst err = 0.076415
epoch = 35 , trn loss = 0.005106 , trn err = 0.071365 , val loss = 0.004699 , val err = 0.099330 , tst loss = 0.007558 , tst err = 0.081923
epoch = 36 , trn loss = 0.004735 , trn err = 0.068720 , val loss = 0.004951 , val err = 0.101965 , tst loss = 0.007464 , tst err = 0.081411
epoch = 37 , trn loss = 0.004791 , trn err = 0.069129 , val loss = 0.004539 , val err = 0.097632 , tst loss = 0.007443 , tst err = 0.081295
epoch = 38 , trn loss = 0.004670 , trn err = 0.068246 , val loss = 0.004818 , val err = 0.100587 , tst loss = 0.007929 , tst err = 0.083911
epoch = 39 , trn loss = 0.004799 , trn err = 0.069182 , val loss = 0.005308 , val err = 0.105572 , tst loss = 0.007956 , tst err = 0.084051
epoch = 40 , trn loss = 0.004677 , trn err = 0.068296 , val loss = 0.004561 , val err = 0.097868 , tst loss = 0.006976 , tst err = 0.078704
epoch = 41 , trn loss = 0.004686 , trn err = 0.068366 , val loss = 0.004571 , val err = 0.097968 , tst loss = 0.007597 , tst err = 0.082137
epoch = 42 , trn loss = 0.004575 , trn err = 0.067553 , val loss = 0.005119 , val err = 0.103675 , tst loss = 0.006496 , tst err = 0.075953
epoch = 43 , trn loss = 0.004674 , trn err = 0.068276 , val loss = 0.004341 , val err = 0.095472 , tst loss = 0.006733 , tst err = 0.077323
epoch = 44 , trn loss = 0.004418 , trn err = 0.066383 , val loss = 0.004710 , val err = 0.099447 , tst loss = 0.007749 , tst err = 0.082953
epoch = 45 , trn loss = 0.004498 , trn err = 0.066979 , val loss = 0.004708 , val err = 0.099428 , tst loss = 0.007624 , tst err = 0.082278
epoch = 46 , trn loss = 0.004447 , trn err = 0.066598 , val loss = 0.005534 , val err = 0.107796 , tst loss = 0.007529 , tst err = 0.081765
epoch = 47 , trn loss = 0.004420 , trn err = 0.066397 , val loss = 0.004593 , val err = 0.098206 , tst loss = 0.009037 , tst err = 0.089582
epoch = 48 , trn loss = 0.004659 , trn err = 0.068169 , val loss = 0.004541 , val err = 0.097651 , tst loss = 0.006797 , tst err = 0.077689
epoch = 49 , trn loss = 0.004404 , trn err = 0.066278 , val loss = 0.004715 , val err = 0.099498 , tst loss = 0.006640 , tst err = 0.076784
epoch = 50 , trn loss = 0.004393 , trn err = 0.066195 , val loss = 0.005036 , val err = 0.102836 , tst loss = 0.009439 , tst err = 0.091553
epoch = 51 , trn loss = 0.004209 , trn err = 0.064791 , val loss = 0.004584 , val err = 0.098109 , tst loss = 0.006780 , tst err = 0.077591
epoch = 52 , trn loss = 0.004434 , trn err = 0.066502 , val loss = 0.004575 , val err = 0.098013 , tst loss = 0.006881 , tst err = 0.078171
epoch = 53 , trn loss = 0.004257 , trn err = 0.065160 , val loss = 0.004951 , val err = 0.101958 , tst loss = 0.008759 , tst err = 0.088195
epoch = 54 , trn loss = 0.004150 , trn err = 0.064334 , val loss = 0.004956 , val err = 0.102014 , tst loss = 0.006775 , tst err = 0.077565
epoch = 55 , trn loss = 0.004215 , trn err = 0.064841 , val loss = 0.005195 , val err = 0.104442 , tst loss = 0.008262 , tst err = 0.085654
epoch = 56 , trn loss = 0.003988 , trn err = 0.063071 , val loss = 0.005358 , val err = 0.106075 , tst loss = 0.008484 , tst err = 0.086797
epoch = 57 , trn loss = 0.004127 , trn err = 0.064160 , val loss = 0.005239 , val err = 0.104888 , tst loss = 0.008318 , tst err = 0.085945
epoch = 58 , trn loss = 0.004248 , trn err = 0.065089 , val loss = 0.004694 , val err = 0.099281 , tst loss = 0.007244 , tst err = 0.080203
epoch = 59 , trn loss = 0.004101 , trn err = 0.063956 , val loss = 0.004591 , val err = 0.098182 , tst loss = 0.006961 , tst err = 0.078622
epoch = 60 , trn loss = 0.004295 , trn err = 0.065455 , val loss = 0.005488 , val err = 0.107348 , tst loss = 0.006902 , tst err = 0.078286
epoch = 61 , trn loss = 0.004102 , trn err = 0.063965 , val loss = 0.004635 , val err = 0.098650 , tst loss = 0.007186 , tst err = 0.079880
epoch = 62 , trn loss = 0.003933 , trn err = 0.062635 , val loss = 0.004840 , val err = 0.100810 , tst loss = 0.006758 , tst err = 0.077466
epoch = 63 , trn loss = 0.003997 , trn err = 0.063140 , val loss = 0.004851 , val err = 0.100931 , tst loss = 0.007237 , tst err = 0.080162
epoch = 64 , trn loss = 0.004014 , trn err = 0.063274 , val loss = 0.004878 , val err = 0.101207 , tst loss = 0.006228 , tst err = 0.074365
epoch = 65 , trn loss = 0.003878 , trn err = 0.062192 , val loss = 0.005140 , val err = 0.103887 , tst loss = 0.007251 , tst err = 0.080245
epoch = 66 , trn loss = 0.003854 , trn err = 0.062003 , val loss = 0.004589 , val err = 0.098161 , tst loss = 0.007357 , tst err = 0.080825
epoch = 67 , trn loss = 0.003809 , trn err = 0.061641 , val loss = 0.005116 , val err = 0.103652 , tst loss = 0.007202 , tst err = 0.079971
epoch = 68 , trn loss = 0.003864 , trn err = 0.062082 , val loss = 0.004817 , val err = 0.100571 , tst loss = 0.006887 , tst err = 0.078200
