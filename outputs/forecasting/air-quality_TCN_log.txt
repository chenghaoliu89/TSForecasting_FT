Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='air-quality', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/air-quality_TCN_bstmodel.pth', model_type='TCN', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 144973
Length of dataset: 5554
Length of dataset: 1871
Length of dataset: 1872
epoch = 1 , trn loss = 0.092673 , trn err = 0.304493 , val loss = 0.088028 , val err = 0.309001 , tst loss = 0.088852 , tst err = 0.344152
epoch = 2 , trn loss = 0.035189 , trn err = 0.187631 , val loss = 0.062315 , val err = 0.259983 , tst loss = 0.062340 , tst err = 0.288271
epoch = 3 , trn loss = 0.030180 , trn err = 0.173765 , val loss = 0.054658 , val err = 0.243486 , tst loss = 0.053592 , tst err = 0.267280
epoch = 4 , trn loss = 0.027814 , trn err = 0.166816 , val loss = 0.051602 , val err = 0.236583 , tst loss = 0.047025 , tst err = 0.250370
epoch = 5 , trn loss = 0.027018 , trn err = 0.164409 , val loss = 0.044442 , val err = 0.219556 , tst loss = 0.040417 , tst err = 0.232112
epoch = 6 , trn loss = 0.024194 , trn err = 0.155581 , val loss = 0.045068 , val err = 0.221096 , tst loss = 0.038435 , tst err = 0.226351
epoch = 7 , trn loss = 0.023615 , trn err = 0.153707 , val loss = 0.043239 , val err = 0.216563 , tst loss = 0.038542 , tst err = 0.226666
epoch = 8 , trn loss = 0.023479 , trn err = 0.153264 , val loss = 0.044435 , val err = 0.219539 , tst loss = 0.038739 , tst err = 0.227243
epoch = 9 , trn loss = 0.022489 , trn err = 0.149998 , val loss = 0.039587 , val err = 0.207217 , tst loss = 0.033452 , tst err = 0.211169
epoch = 10 , trn loss = 0.021656 , trn err = 0.147194 , val loss = 0.038896 , val err = 0.205400 , tst loss = 0.032862 , tst err = 0.209297
epoch = 11 , trn loss = 0.021487 , trn err = 0.146617 , val loss = 0.038217 , val err = 0.203599 , tst loss = 0.031283 , tst err = 0.204208
epoch = 12 , trn loss = 0.021676 , trn err = 0.147264 , val loss = 0.038442 , val err = 0.204198 , tst loss = 0.032184 , tst err = 0.207127
epoch = 13 , trn loss = 0.020898 , trn err = 0.144595 , val loss = 0.039235 , val err = 0.206293 , tst loss = 0.032988 , tst err = 0.209700
epoch = 14 , trn loss = 0.020539 , trn err = 0.143347 , val loss = 0.039164 , val err = 0.206106 , tst loss = 0.033555 , tst err = 0.211494
epoch = 15 , trn loss = 0.020162 , trn err = 0.142026 , val loss = 0.036747 , val err = 0.199646 , tst loss = 0.030749 , tst err = 0.202458
epoch = 16 , trn loss = 0.019964 , trn err = 0.141327 , val loss = 0.037211 , val err = 0.200904 , tst loss = 0.028508 , tst err = 0.194939
epoch = 17 , trn loss = 0.020429 , trn err = 0.142962 , val loss = 0.038256 , val err = 0.203703 , tst loss = 0.030938 , tst err = 0.203077
epoch = 18 , trn loss = 0.019477 , trn err = 0.139593 , val loss = 0.046858 , val err = 0.225446 , tst loss = 0.039093 , tst err = 0.228278
epoch = 19 , trn loss = 0.020080 , trn err = 0.141737 , val loss = 0.038904 , val err = 0.205422 , tst loss = 0.031530 , tst err = 0.205011
epoch = 20 , trn loss = 0.019721 , trn err = 0.140464 , val loss = 0.050064 , val err = 0.233031 , tst loss = 0.044452 , tst err = 0.243424
epoch = 21 , trn loss = 0.019563 , trn err = 0.139901 , val loss = 0.035644 , val err = 0.196626 , tst loss = 0.029038 , tst err = 0.196744
epoch = 22 , trn loss = 0.018705 , trn err = 0.136798 , val loss = 0.046006 , val err = 0.223385 , tst loss = 0.036803 , tst err = 0.221491
epoch = 23 , trn loss = 0.019075 , trn err = 0.138145 , val loss = 0.040504 , val err = 0.209604 , tst loss = 0.032920 , tst err = 0.209481
epoch = 24 , trn loss = 0.018195 , trn err = 0.134919 , val loss = 0.037109 , val err = 0.200626 , tst loss = 0.030484 , tst err = 0.201583
epoch = 25 , trn loss = 0.018405 , trn err = 0.135697 , val loss = 0.042911 , val err = 0.215742 , tst loss = 0.032213 , tst err = 0.207220
epoch = 26 , trn loss = 0.017803 , trn err = 0.133461 , val loss = 0.040056 , val err = 0.208440 , tst loss = 0.032743 , tst err = 0.208919
epoch = 27 , trn loss = 0.018041 , trn err = 0.134349 , val loss = 0.039211 , val err = 0.206230 , tst loss = 0.030700 , tst err = 0.202295
epoch = 28 , trn loss = 0.017371 , trn err = 0.131830 , val loss = 0.042481 , val err = 0.214657 , tst loss = 0.035346 , tst err = 0.217062
epoch = 29 , trn loss = 0.017991 , trn err = 0.134162 , val loss = 0.042416 , val err = 0.214493 , tst loss = 0.034191 , tst err = 0.213487
epoch = 30 , trn loss = 0.017493 , trn err = 0.132290 , val loss = 0.038651 , val err = 0.204752 , tst loss = 0.031862 , tst err = 0.206088
epoch = 31 , trn loss = 0.017124 , trn err = 0.130888 , val loss = 0.041505 , val err = 0.212178 , tst loss = 0.034654 , tst err = 0.214929
epoch = 32 , trn loss = 0.016820 , trn err = 0.129722 , val loss = 0.037705 , val err = 0.202232 , tst loss = 0.029747 , tst err = 0.199132
epoch = 33 , trn loss = 0.017088 , trn err = 0.130752 , val loss = 0.042226 , val err = 0.214014 , tst loss = 0.036432 , tst err = 0.220373
epoch = 34 , trn loss = 0.016825 , trn err = 0.129743 , val loss = 0.040684 , val err = 0.210069 , tst loss = 0.033142 , tst err = 0.210189
epoch = 35 , trn loss = 0.016965 , trn err = 0.130281 , val loss = 0.040978 , val err = 0.210827 , tst loss = 0.030786 , tst err = 0.202578
epoch = 36 , trn loss = 0.015921 , trn err = 0.126207 , val loss = 0.048404 , val err = 0.229134 , tst loss = 0.036326 , tst err = 0.220053
epoch = 37 , trn loss = 0.016123 , trn err = 0.127008 , val loss = 0.043329 , val err = 0.216790 , tst loss = 0.037435 , tst err = 0.223385
epoch = 38 , trn loss = 0.015649 , trn err = 0.125123 , val loss = 0.044686 , val err = 0.220159 , tst loss = 0.035376 , tst err = 0.217157
epoch = 39 , trn loss = 0.015944 , trn err = 0.126301 , val loss = 0.046489 , val err = 0.224556 , tst loss = 0.040819 , tst err = 0.233263
epoch = 40 , trn loss = 0.015560 , trn err = 0.124769 , val loss = 0.048129 , val err = 0.228483 , tst loss = 0.040627 , tst err = 0.232715
epoch = 41 , trn loss = 0.015976 , trn err = 0.126425 , val loss = 0.044688 , val err = 0.220163 , tst loss = 0.038207 , tst err = 0.225679
epoch = 42 , trn loss = 0.016104 , trn err = 0.126931 , val loss = 0.041047 , val err = 0.211003 , tst loss = 0.036030 , tst err = 0.219154
epoch = 43 , trn loss = 0.014903 , trn err = 0.122107 , val loss = 0.050403 , val err = 0.233818 , tst loss = 0.044078 , tst err = 0.242396
epoch = 44 , trn loss = 0.014801 , trn err = 0.121689 , val loss = 0.048907 , val err = 0.230322 , tst loss = 0.041400 , tst err = 0.234917
epoch = 45 , trn loss = 0.014719 , trn err = 0.121352 , val loss = 0.050644 , val err = 0.234375 , tst loss = 0.043714 , tst err = 0.241393
epoch = 46 , trn loss = 0.015791 , trn err = 0.125691 , val loss = 0.065765 , val err = 0.267083 , tst loss = 0.063955 , tst err = 0.291981
