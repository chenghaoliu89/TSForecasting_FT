Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='electricity', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/electricity_LSTM_bstmodel.pth', model_type='LSTM', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 153217
Length of dataset: 15722
Length of dataset: 5261
Length of dataset: 5261
epoch = 1 , trn loss = 0.256068 , trn err = 0.505376 , val loss = 0.011741 , val err = 0.157019 , tst loss = 0.036435 , tst err = 0.179873
epoch = 2 , trn loss = 0.018836 , trn err = 0.137067 , val loss = 0.006669 , val err = 0.118336 , tst loss = 0.014410 , tst err = 0.113118
epoch = 3 , trn loss = 0.010782 , trn err = 0.103701 , val loss = 0.005991 , val err = 0.112163 , tst loss = 0.010021 , tst err = 0.094330
epoch = 4 , trn loss = 0.008910 , trn err = 0.094270 , val loss = 0.005623 , val err = 0.108664 , tst loss = 0.011353 , tst err = 0.100405
epoch = 5 , trn loss = 0.008393 , trn err = 0.091495 , val loss = 0.006668 , val err = 0.118327 , tst loss = 0.010108 , tst err = 0.094743
epoch = 6 , trn loss = 0.007789 , trn err = 0.088141 , val loss = 0.005329 , val err = 0.105780 , tst loss = 0.008321 , tst err = 0.085957
epoch = 7 , trn loss = 0.007372 , trn err = 0.085748 , val loss = 0.006247 , val err = 0.114530 , tst loss = 0.011210 , tst err = 0.099772
epoch = 8 , trn loss = 0.007257 , trn err = 0.085080 , val loss = 0.005386 , val err = 0.106347 , tst loss = 0.009497 , tst err = 0.091833
epoch = 9 , trn loss = 0.006909 , trn err = 0.083012 , val loss = 0.005196 , val err = 0.104456 , tst loss = 0.008383 , tst err = 0.086281
epoch = 10 , trn loss = 0.006651 , trn err = 0.081447 , val loss = 0.006679 , val err = 0.118423 , tst loss = 0.009692 , tst err = 0.092771
epoch = 11 , trn loss = 0.006657 , trn err = 0.081483 , val loss = 0.006865 , val err = 0.120068 , tst loss = 0.010673 , tst err = 0.097351
epoch = 12 , trn loss = 0.006373 , trn err = 0.079726 , val loss = 0.005654 , val err = 0.108966 , tst loss = 0.008574 , tst err = 0.087255
epoch = 13 , trn loss = 0.006740 , trn err = 0.081988 , val loss = 0.005058 , val err = 0.103054 , tst loss = 0.008818 , tst err = 0.088487
epoch = 14 , trn loss = 0.006254 , trn err = 0.078983 , val loss = 0.005492 , val err = 0.107388 , tst loss = 0.008485 , tst err = 0.086804
epoch = 15 , trn loss = 0.006043 , trn err = 0.077636 , val loss = 0.005261 , val err = 0.105101 , tst loss = 0.008955 , tst err = 0.089172
epoch = 16 , trn loss = 0.006193 , trn err = 0.078591 , val loss = 0.005089 , val err = 0.103370 , tst loss = 0.007160 , tst err = 0.079739
epoch = 17 , trn loss = 0.005860 , trn err = 0.076453 , val loss = 0.005313 , val err = 0.105627 , tst loss = 0.008560 , tst err = 0.087186
epoch = 18 , trn loss = 0.005693 , trn err = 0.075351 , val loss = 0.005129 , val err = 0.103774 , tst loss = 0.008592 , tst err = 0.087350
epoch = 19 , trn loss = 0.005632 , trn err = 0.074952 , val loss = 0.005064 , val err = 0.103118 , tst loss = 0.008539 , tst err = 0.087079
epoch = 20 , trn loss = 0.005562 , trn err = 0.074484 , val loss = 0.005094 , val err = 0.103428 , tst loss = 0.009214 , tst err = 0.090454
epoch = 21 , trn loss = 0.005618 , trn err = 0.074853 , val loss = 0.005205 , val err = 0.104549 , tst loss = 0.007882 , tst err = 0.083659
epoch = 22 , trn loss = 0.005599 , trn err = 0.074727 , val loss = 0.005411 , val err = 0.106589 , tst loss = 0.007866 , tst err = 0.083573
epoch = 23 , trn loss = 0.005516 , trn err = 0.074174 , val loss = 0.006099 , val err = 0.113170 , tst loss = 0.008738 , tst err = 0.088089
epoch = 24 , trn loss = 0.005351 , trn err = 0.073055 , val loss = 0.006147 , val err = 0.113612 , tst loss = 0.009020 , tst err = 0.089498
epoch = 25 , trn loss = 0.005353 , trn err = 0.073069 , val loss = 0.005256 , val err = 0.105061 , tst loss = 0.007147 , tst err = 0.079667
epoch = 26 , trn loss = 0.005219 , trn err = 0.072151 , val loss = 0.005113 , val err = 0.103614 , tst loss = 0.008983 , tst err = 0.089315
epoch = 27 , trn loss = 0.005000 , trn err = 0.070618 , val loss = 0.005222 , val err = 0.104712 , tst loss = 0.008466 , tst err = 0.086703
epoch = 28 , trn loss = 0.005242 , trn err = 0.072308 , val loss = 0.005797 , val err = 0.110333 , tst loss = 0.008820 , tst err = 0.088500
epoch = 29 , trn loss = 0.005022 , trn err = 0.070773 , val loss = 0.005310 , val err = 0.105594 , tst loss = 0.007946 , tst err = 0.084001
epoch = 30 , trn loss = 0.004993 , trn err = 0.070566 , val loss = 0.005450 , val err = 0.106982 , tst loss = 0.008817 , tst err = 0.088483
epoch = 31 , trn loss = 0.005015 , trn err = 0.070723 , val loss = 0.005299 , val err = 0.105483 , tst loss = 0.008017 , tst err = 0.084372
epoch = 32 , trn loss = 0.004892 , trn err = 0.069850 , val loss = 0.004725 , val err = 0.099610 , tst loss = 0.008768 , tst err = 0.088238
epoch = 33 , trn loss = 0.004842 , trn err = 0.069494 , val loss = 0.005045 , val err = 0.102930 , tst loss = 0.007560 , tst err = 0.081933
epoch = 34 , trn loss = 0.004889 , trn err = 0.069832 , val loss = 0.005488 , val err = 0.107345 , tst loss = 0.008583 , tst err = 0.087300
epoch = 35 , trn loss = 0.004755 , trn err = 0.068864 , val loss = 0.004881 , val err = 0.101234 , tst loss = 0.008003 , tst err = 0.084302
epoch = 36 , trn loss = 0.004654 , trn err = 0.068129 , val loss = 0.005361 , val err = 0.106104 , tst loss = 0.008527 , tst err = 0.087018
epoch = 37 , trn loss = 0.004742 , trn err = 0.068775 , val loss = 0.005100 , val err = 0.103485 , tst loss = 0.007138 , tst err = 0.079613
epoch = 38 , trn loss = 0.004715 , trn err = 0.068577 , val loss = 0.005464 , val err = 0.107115 , tst loss = 0.008643 , tst err = 0.087608
epoch = 39 , trn loss = 0.004648 , trn err = 0.068086 , val loss = 0.004668 , val err = 0.099003 , tst loss = 0.008028 , tst err = 0.084434
epoch = 40 , trn loss = 0.004544 , trn err = 0.067319 , val loss = 0.004783 , val err = 0.100220 , tst loss = 0.007605 , tst err = 0.082176
epoch = 41 , trn loss = 0.004593 , trn err = 0.067682 , val loss = 0.005202 , val err = 0.104516 , tst loss = 0.007545 , tst err = 0.081855
epoch = 42 , trn loss = 0.004458 , trn err = 0.066685 , val loss = 0.005071 , val err = 0.103186 , tst loss = 0.007699 , tst err = 0.082683
epoch = 43 , trn loss = 0.004573 , trn err = 0.067534 , val loss = 0.004880 , val err = 0.101224 , tst loss = 0.007118 , tst err = 0.079501
epoch = 44 , trn loss = 0.004552 , trn err = 0.067379 , val loss = 0.004991 , val err = 0.102371 , tst loss = 0.008780 , tst err = 0.088300
epoch = 45 , trn loss = 0.004369 , trn err = 0.066017 , val loss = 0.004669 , val err = 0.099016 , tst loss = 0.008576 , tst err = 0.087268
epoch = 46 , trn loss = 0.004320 , trn err = 0.065639 , val loss = 0.004737 , val err = 0.099736 , tst loss = 0.007305 , tst err = 0.080540
epoch = 47 , trn loss = 0.004268 , trn err = 0.065248 , val loss = 0.004711 , val err = 0.099458 , tst loss = 0.008195 , tst err = 0.085303
epoch = 48 , trn loss = 0.004325 , trn err = 0.065683 , val loss = 0.004833 , val err = 0.100739 , tst loss = 0.007290 , tst err = 0.080458
epoch = 49 , trn loss = 0.004184 , trn err = 0.064599 , val loss = 0.005148 , val err = 0.103969 , tst loss = 0.007422 , tst err = 0.081182
epoch = 50 , trn loss = 0.004301 , trn err = 0.065495 , val loss = 0.005335 , val err = 0.105840 , tst loss = 0.007664 , tst err = 0.082496
epoch = 51 , trn loss = 0.004191 , trn err = 0.064653 , val loss = 0.005056 , val err = 0.103038 , tst loss = 0.008641 , tst err = 0.087598
epoch = 52 , trn loss = 0.004170 , trn err = 0.064490 , val loss = 0.005237 , val err = 0.104864 , tst loss = 0.007323 , tst err = 0.080638
epoch = 53 , trn loss = 0.004164 , trn err = 0.064447 , val loss = 0.005008 , val err = 0.102546 , tst loss = 0.007401 , tst err = 0.081067
epoch = 54 , trn loss = 0.004020 , trn err = 0.063323 , val loss = 0.004766 , val err = 0.100035 , tst loss = 0.009002 , tst err = 0.089409
epoch = 55 , trn loss = 0.004027 , trn err = 0.063374 , val loss = 0.005012 , val err = 0.102593 , tst loss = 0.008174 , tst err = 0.085196
epoch = 56 , trn loss = 0.004007 , trn err = 0.063221 , val loss = 0.004722 , val err = 0.099573 , tst loss = 0.008723 , tst err = 0.088013
epoch = 57 , trn loss = 0.004082 , trn err = 0.063811 , val loss = 0.004858 , val err = 0.100996 , tst loss = 0.008349 , tst err = 0.086105
epoch = 58 , trn loss = 0.003936 , trn err = 0.062660 , val loss = 0.004936 , val err = 0.101804 , tst loss = 0.007014 , tst err = 0.078918
epoch = 59 , trn loss = 0.003991 , trn err = 0.063095 , val loss = 0.005217 , val err = 0.104670 , tst loss = 0.007810 , tst err = 0.083279
epoch = 60 , trn loss = 0.003925 , trn err = 0.062569 , val loss = 0.004982 , val err = 0.102280 , tst loss = 0.007890 , tst err = 0.083704
epoch = 61 , trn loss = 0.003975 , trn err = 0.062963 , val loss = 0.004660 , val err = 0.098916 , tst loss = 0.008462 , tst err = 0.086686
epoch = 62 , trn loss = 0.003880 , trn err = 0.062206 , val loss = 0.004836 , val err = 0.100770 , tst loss = 0.008197 , tst err = 0.085314
epoch = 63 , trn loss = 0.003822 , trn err = 0.061743 , val loss = 0.004892 , val err = 0.101354 , tst loss = 0.007844 , tst err = 0.083457
epoch = 64 , trn loss = 0.003835 , trn err = 0.061848 , val loss = 0.004729 , val err = 0.099655 , tst loss = 0.007988 , tst err = 0.084224
epoch = 65 , trn loss = 0.003786 , trn err = 0.061451 , val loss = 0.004622 , val err = 0.098514 , tst loss = 0.007075 , tst err = 0.079263
epoch = 66 , trn loss = 0.003811 , trn err = 0.061651 , val loss = 0.004941 , val err = 0.101862 , tst loss = 0.007895 , tst err = 0.083732
epoch = 67 , trn loss = 0.003813 , trn err = 0.061672 , val loss = 0.004870 , val err = 0.101129 , tst loss = 0.007509 , tst err = 0.081659
epoch = 68 , trn loss = 0.003737 , trn err = 0.061055 , val loss = 0.004725 , val err = 0.099613 , tst loss = 0.008504 , tst err = 0.086897
epoch = 69 , trn loss = 0.003659 , trn err = 0.060413 , val loss = 0.005019 , val err = 0.102661 , tst loss = 0.007869 , tst err = 0.083594
epoch = 70 , trn loss = 0.003777 , trn err = 0.061374 , val loss = 0.004834 , val err = 0.100746 , tst loss = 0.007151 , tst err = 0.079689
epoch = 71 , trn loss = 0.003649 , trn err = 0.060325 , val loss = 0.004781 , val err = 0.100194 , tst loss = 0.007648 , tst err = 0.082409
epoch = 72 , trn loss = 0.003658 , trn err = 0.060400 , val loss = 0.004858 , val err = 0.101003 , tst loss = 0.007799 , tst err = 0.083219
epoch = 73 , trn loss = 0.003684 , trn err = 0.060613 , val loss = 0.004766 , val err = 0.100035 , tst loss = 0.007766 , tst err = 0.083046
epoch = 74 , trn loss = 0.003567 , trn err = 0.059647 , val loss = 0.004734 , val err = 0.099698 , tst loss = 0.008249 , tst err = 0.085589
epoch = 75 , trn loss = 0.003546 , trn err = 0.059471 , val loss = 0.004863 , val err = 0.101056 , tst loss = 0.007552 , tst err = 0.081891
epoch = 76 , trn loss = 0.003573 , trn err = 0.059694 , val loss = 0.005133 , val err = 0.103821 , tst loss = 0.007342 , tst err = 0.080746
epoch = 77 , trn loss = 0.003538 , trn err = 0.059408 , val loss = 0.004741 , val err = 0.099777 , tst loss = 0.008164 , tst err = 0.085145
epoch = 78 , trn loss = 0.003489 , trn err = 0.058994 , val loss = 0.005491 , val err = 0.107384 , tst loss = 0.007875 , tst err = 0.083625
epoch = 79 , trn loss = 0.003538 , trn err = 0.059408 , val loss = 0.004906 , val err = 0.101494 , tst loss = 0.007149 , tst err = 0.079675
epoch = 80 , trn loss = 0.003464 , trn err = 0.058782 , val loss = 0.004671 , val err = 0.099042 , tst loss = 0.007831 , tst err = 0.083392
epoch = 81 , trn loss = 0.003348 , trn err = 0.057789 , val loss = 0.004903 , val err = 0.101462 , tst loss = 0.007676 , tst err = 0.082561
epoch = 82 , trn loss = 0.003502 , trn err = 0.059100 , val loss = 0.004771 , val err = 0.100096 , tst loss = 0.007639 , tst err = 0.082361
epoch = 83 , trn loss = 0.003367 , trn err = 0.057948 , val loss = 0.005044 , val err = 0.102913 , tst loss = 0.007430 , tst err = 0.081229
epoch = 84 , trn loss = 0.003322 , trn err = 0.057559 , val loss = 0.004707 , val err = 0.099416 , tst loss = 0.007976 , tst err = 0.084156
epoch = 85 , trn loss = 0.003383 , trn err = 0.058091 , val loss = 0.004964 , val err = 0.102093 , tst loss = 0.007736 , tst err = 0.082885
epoch = 86 , trn loss = 0.003435 , trn err = 0.058537 , val loss = 0.004926 , val err = 0.101706 , tst loss = 0.007610 , tst err = 0.082206
epoch = 87 , trn loss = 0.003491 , trn err = 0.059007 , val loss = 0.005084 , val err = 0.103323 , tst loss = 0.007247 , tst err = 0.080220
epoch = 88 , trn loss = 0.003376 , trn err = 0.058032 , val loss = 0.005173 , val err = 0.104226 , tst loss = 0.007714 , tst err = 0.082763
epoch = 89 , trn loss = 0.003320 , trn err = 0.057548 , val loss = 0.005082 , val err = 0.103306 , tst loss = 0.008016 , tst err = 0.084368
epoch = 90 , trn loss = 0.003201 , trn err = 0.056501 , val loss = 0.005072 , val err = 0.103203 , tst loss = 0.009251 , tst err = 0.090635
