Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='exchange', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/exchange_LSTM_bstmodel.pth', model_type='LSTM', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 52744
Length of dataset: 4492
Length of dataset: 1518
Length of dataset: 1518
epoch = 1 , trn loss = 0.105389 , trn err = 0.324499 , val loss = 0.124411 , val err = 0.345375 , tst loss = 0.124028 , tst err = 0.366704
epoch = 2 , trn loss = 0.018759 , trn err = 0.136906 , val loss = 0.082444 , val err = 0.281151 , tst loss = 0.105056 , tst err = 0.337495
epoch = 3 , trn loss = 0.008054 , trn err = 0.089708 , val loss = 0.089796 , val err = 0.293420 , tst loss = 0.092777 , tst err = 0.317158
epoch = 4 , trn loss = 0.004851 , trn err = 0.069622 , val loss = 0.049770 , val err = 0.218446 , tst loss = 0.050527 , tst err = 0.234054
epoch = 5 , trn loss = 0.003660 , trn err = 0.060470 , val loss = 0.042456 , val err = 0.201758 , tst loss = 0.041551 , tst err = 0.212249
epoch = 6 , trn loss = 0.003443 , trn err = 0.058654 , val loss = 0.040906 , val err = 0.198042 , tst loss = 0.039138 , tst err = 0.205996
epoch = 7 , trn loss = 0.002725 , trn err = 0.052184 , val loss = 0.038556 , val err = 0.192268 , tst loss = 0.040852 , tst err = 0.210458
epoch = 8 , trn loss = 0.001682 , trn err = 0.040993 , val loss = 0.037877 , val err = 0.190568 , tst loss = 0.038378 , tst err = 0.203986
epoch = 9 , trn loss = 0.001422 , trn err = 0.037690 , val loss = 0.040605 , val err = 0.197310 , tst loss = 0.040630 , tst err = 0.209885
epoch = 10 , trn loss = 0.001362 , trn err = 0.036894 , val loss = 0.036193 , val err = 0.186283 , tst loss = 0.035147 , tst err = 0.195210
epoch = 11 , trn loss = 0.001242 , trn err = 0.035231 , val loss = 0.039991 , val err = 0.195814 , tst loss = 0.037279 , tst err = 0.201042
epoch = 12 , trn loss = 0.001054 , trn err = 0.032449 , val loss = 0.035050 , val err = 0.183319 , tst loss = 0.029889 , tst err = 0.180017
epoch = 13 , trn loss = 0.000915 , trn err = 0.030244 , val loss = 0.032422 , val err = 0.176312 , tst loss = 0.025676 , tst err = 0.166849
epoch = 14 , trn loss = 0.000710 , trn err = 0.026637 , val loss = 0.031551 , val err = 0.173929 , tst loss = 0.025077 , tst err = 0.164891
epoch = 15 , trn loss = 0.000570 , trn err = 0.023869 , val loss = 0.026766 , val err = 0.160197 , tst loss = 0.022351 , tst err = 0.155670
epoch = 16 , trn loss = 0.000509 , trn err = 0.022542 , val loss = 0.025502 , val err = 0.156370 , tst loss = 0.020948 , tst err = 0.150705
epoch = 17 , trn loss = 0.000473 , trn err = 0.021743 , val loss = 0.025425 , val err = 0.156131 , tst loss = 0.020520 , tst err = 0.149158
epoch = 18 , trn loss = 0.000444 , trn err = 0.021063 , val loss = 0.024095 , val err = 0.151993 , tst loss = 0.019580 , tst err = 0.145702
epoch = 19 , trn loss = 0.000427 , trn err = 0.020647 , val loss = 0.023654 , val err = 0.150595 , tst loss = 0.019957 , tst err = 0.147097
epoch = 20 , trn loss = 0.000449 , trn err = 0.021172 , val loss = 0.023871 , val err = 0.151284 , tst loss = 0.019410 , tst err = 0.145069
epoch = 21 , trn loss = 0.000422 , trn err = 0.020537 , val loss = 0.023702 , val err = 0.150750 , tst loss = 0.019580 , tst err = 0.145700
epoch = 22 , trn loss = 0.000364 , trn err = 0.019059 , val loss = 0.022867 , val err = 0.148068 , tst loss = 0.018762 , tst err = 0.142625
epoch = 23 , trn loss = 0.000376 , trn err = 0.019372 , val loss = 0.021678 , val err = 0.144168 , tst loss = 0.018279 , tst err = 0.140779
epoch = 24 , trn loss = 0.000354 , trn err = 0.018796 , val loss = 0.018680 , val err = 0.133829 , tst loss = 0.016400 , tst err = 0.133345
epoch = 25 , trn loss = 0.000422 , trn err = 0.020532 , val loss = 0.021060 , val err = 0.142099 , tst loss = 0.018495 , tst err = 0.141608
epoch = 26 , trn loss = 0.000382 , trn err = 0.019548 , val loss = 0.018954 , val err = 0.134807 , tst loss = 0.016443 , tst err = 0.133519
epoch = 27 , trn loss = 0.000354 , trn err = 0.018818 , val loss = 0.015851 , val err = 0.123281 , tst loss = 0.014076 , tst err = 0.123536
epoch = 28 , trn loss = 0.000327 , trn err = 0.018066 , val loss = 0.018531 , val err = 0.133293 , tst loss = 0.016788 , tst err = 0.134915
epoch = 29 , trn loss = 0.000313 , trn err = 0.017687 , val loss = 0.015768 , val err = 0.122954 , tst loss = 0.014751 , tst err = 0.126466
epoch = 30 , trn loss = 0.000343 , trn err = 0.018506 , val loss = 0.014186 , val err = 0.116626 , tst loss = 0.013267 , tst err = 0.119936
epoch = 31 , trn loss = 0.000335 , trn err = 0.018309 , val loss = 0.015444 , val err = 0.121686 , tst loss = 0.014306 , tst err = 0.124541
epoch = 32 , trn loss = 0.000283 , trn err = 0.016819 , val loss = 0.013281 , val err = 0.112843 , tst loss = 0.012588 , tst err = 0.116826
epoch = 33 , trn loss = 0.000321 , trn err = 0.017917 , val loss = 0.012295 , val err = 0.108573 , tst loss = 0.011515 , tst err = 0.111736
epoch = 34 , trn loss = 0.000275 , trn err = 0.016576 , val loss = 0.012128 , val err = 0.107834 , tst loss = 0.011374 , tst err = 0.111050
epoch = 35 , trn loss = 0.000307 , trn err = 0.017524 , val loss = 0.014323 , val err = 0.117189 , tst loss = 0.013525 , tst err = 0.121093
epoch = 36 , trn loss = 0.000289 , trn err = 0.016980 , val loss = 0.011015 , val err = 0.102768 , tst loss = 0.010358 , tst err = 0.105971
epoch = 37 , trn loss = 0.000300 , trn err = 0.017300 , val loss = 0.012213 , val err = 0.108212 , tst loss = 0.011562 , tst err = 0.111962
epoch = 38 , trn loss = 0.000262 , trn err = 0.016179 , val loss = 0.012716 , val err = 0.110417 , tst loss = 0.011659 , tst err = 0.112432
epoch = 39 , trn loss = 0.000230 , trn err = 0.015148 , val loss = 0.011961 , val err = 0.107089 , tst loss = 0.011206 , tst err = 0.110225
epoch = 40 , trn loss = 0.000245 , trn err = 0.015650 , val loss = 0.011860 , val err = 0.106638 , tst loss = 0.011204 , tst err = 0.110213
epoch = 41 , trn loss = 0.000225 , trn err = 0.015010 , val loss = 0.009796 , val err = 0.096915 , tst loss = 0.009631 , tst err = 0.102188
epoch = 42 , trn loss = 0.000241 , trn err = 0.015519 , val loss = 0.010382 , val err = 0.099769 , tst loss = 0.009508 , tst err = 0.101534
epoch = 43 , trn loss = 0.000247 , trn err = 0.015723 , val loss = 0.010505 , val err = 0.100361 , tst loss = 0.010031 , tst err = 0.104289
epoch = 44 , trn loss = 0.000205 , trn err = 0.014298 , val loss = 0.010408 , val err = 0.099897 , tst loss = 0.010050 , tst err = 0.104383
epoch = 45 , trn loss = 0.000223 , trn err = 0.014934 , val loss = 0.010194 , val err = 0.098862 , tst loss = 0.009307 , tst err = 0.100452
epoch = 46 , trn loss = 0.000217 , trn err = 0.014708 , val loss = 0.009991 , val err = 0.097873 , tst loss = 0.009743 , tst err = 0.102780
epoch = 47 , trn loss = 0.000228 , trn err = 0.015092 , val loss = 0.011485 , val err = 0.104937 , tst loss = 0.010809 , tst err = 0.108258
epoch = 48 , trn loss = 0.000225 , trn err = 0.015001 , val loss = 0.010024 , val err = 0.098033 , tst loss = 0.009397 , tst err = 0.100935
epoch = 49 , trn loss = 0.000243 , trn err = 0.015592 , val loss = 0.010259 , val err = 0.099180 , tst loss = 0.009915 , tst err = 0.103680
epoch = 50 , trn loss = 0.000201 , trn err = 0.014161 , val loss = 0.010137 , val err = 0.098588 , tst loss = 0.009897 , tst err = 0.103585
epoch = 51 , trn loss = 0.000210 , trn err = 0.014489 , val loss = 0.009762 , val err = 0.096745 , tst loss = 0.008996 , tst err = 0.098758
epoch = 52 , trn loss = 0.000230 , trn err = 0.015171 , val loss = 0.010086 , val err = 0.098337 , tst loss = 0.009371 , tst err = 0.100799
epoch = 53 , trn loss = 0.000226 , trn err = 0.015037 , val loss = 0.009590 , val err = 0.095890 , tst loss = 0.009217 , tst err = 0.099968
epoch = 54 , trn loss = 0.000238 , trn err = 0.015436 , val loss = 0.008989 , val err = 0.092836 , tst loss = 0.008697 , tst err = 0.097103
epoch = 55 , trn loss = 0.000196 , trn err = 0.013979 , val loss = 0.008116 , val err = 0.088214 , tst loss = 0.008011 , tst err = 0.093196
epoch = 56 , trn loss = 0.000217 , trn err = 0.014742 , val loss = 0.010104 , val err = 0.098425 , tst loss = 0.010114 , tst err = 0.104718
epoch = 57 , trn loss = 0.000218 , trn err = 0.014763 , val loss = 0.009972 , val err = 0.097783 , tst loss = 0.009564 , tst err = 0.101828
epoch = 58 , trn loss = 0.000202 , trn err = 0.014214 , val loss = 0.009997 , val err = 0.097901 , tst loss = 0.009721 , tst err = 0.102661
epoch = 59 , trn loss = 0.000210 , trn err = 0.014500 , val loss = 0.010533 , val err = 0.100494 , tst loss = 0.009788 , tst err = 0.103013
epoch = 60 , trn loss = 0.000209 , trn err = 0.014444 , val loss = 0.009550 , val err = 0.095691 , tst loss = 0.009149 , tst err = 0.099597
epoch = 61 , trn loss = 0.000232 , trn err = 0.015219 , val loss = 0.008911 , val err = 0.092431 , tst loss = 0.008615 , tst err = 0.096644
epoch = 62 , trn loss = 0.000204 , trn err = 0.014286 , val loss = 0.008623 , val err = 0.090924 , tst loss = 0.008135 , tst err = 0.093915
epoch = 63 , trn loss = 0.000224 , trn err = 0.014952 , val loss = 0.008605 , val err = 0.090833 , tst loss = 0.008314 , tst err = 0.094943
epoch = 64 , trn loss = 0.000191 , trn err = 0.013813 , val loss = 0.009352 , val err = 0.094694 , tst loss = 0.008959 , tst err = 0.098555
epoch = 65 , trn loss = 0.000189 , trn err = 0.013734 , val loss = 0.007293 , val err = 0.083621 , tst loss = 0.006672 , tst err = 0.085054
epoch = 66 , trn loss = 0.000220 , trn err = 0.014821 , val loss = 0.008203 , val err = 0.088683 , tst loss = 0.007981 , tst err = 0.093021
epoch = 67 , trn loss = 0.000189 , trn err = 0.013753 , val loss = 0.008387 , val err = 0.089671 , tst loss = 0.008211 , tst err = 0.094351
epoch = 68 , trn loss = 0.000221 , trn err = 0.014855 , val loss = 0.008381 , val err = 0.089644 , tst loss = 0.008017 , tst err = 0.093232
epoch = 69 , trn loss = 0.000220 , trn err = 0.014819 , val loss = 0.009222 , val err = 0.094032 , tst loss = 0.008425 , tst err = 0.095574
epoch = 70 , trn loss = 0.000200 , trn err = 0.014139 , val loss = 0.008948 , val err = 0.092622 , tst loss = 0.008470 , tst err = 0.095831
epoch = 71 , trn loss = 0.000177 , trn err = 0.013286 , val loss = 0.008005 , val err = 0.087610 , tst loss = 0.007617 , tst err = 0.090876
epoch = 72 , trn loss = 0.000211 , trn err = 0.014518 , val loss = 0.007884 , val err = 0.086941 , tst loss = 0.007674 , tst err = 0.091216
epoch = 73 , trn loss = 0.000215 , trn err = 0.014658 , val loss = 0.008699 , val err = 0.091327 , tst loss = 0.008193 , tst err = 0.094250
epoch = 74 , trn loss = 0.000242 , trn err = 0.015554 , val loss = 0.009022 , val err = 0.093007 , tst loss = 0.008749 , tst err = 0.097395
epoch = 75 , trn loss = 0.000226 , trn err = 0.015024 , val loss = 0.007905 , val err = 0.087061 , tst loss = 0.007435 , tst err = 0.089785
epoch = 76 , trn loss = 0.000191 , trn err = 0.013808 , val loss = 0.008104 , val err = 0.088150 , tst loss = 0.007800 , tst err = 0.091962
epoch = 77 , trn loss = 0.000158 , trn err = 0.012550 , val loss = 0.009010 , val err = 0.092946 , tst loss = 0.008576 , tst err = 0.096430
epoch = 78 , trn loss = 0.000191 , trn err = 0.013831 , val loss = 0.008618 , val err = 0.090902 , tst loss = 0.008105 , tst err = 0.093741
epoch = 79 , trn loss = 0.000164 , trn err = 0.012791 , val loss = 0.008761 , val err = 0.091649 , tst loss = 0.008216 , tst err = 0.094384
epoch = 80 , trn loss = 0.000172 , trn err = 0.013121 , val loss = 0.008140 , val err = 0.088343 , tst loss = 0.007761 , tst err = 0.091731
epoch = 81 , trn loss = 0.000217 , trn err = 0.014709 , val loss = 0.007936 , val err = 0.087232 , tst loss = 0.007294 , tst err = 0.088930
epoch = 82 , trn loss = 0.000195 , trn err = 0.013973 , val loss = 0.007744 , val err = 0.086167 , tst loss = 0.007437 , tst err = 0.089798
epoch = 83 , trn loss = 0.000211 , trn err = 0.014525 , val loss = 0.008481 , val err = 0.090173 , tst loss = 0.008220 , tst err = 0.094405
epoch = 84 , trn loss = 0.000177 , trn err = 0.013283 , val loss = 0.008341 , val err = 0.089430 , tst loss = 0.008004 , tst err = 0.093156
epoch = 85 , trn loss = 0.000170 , trn err = 0.013017 , val loss = 0.007679 , val err = 0.085808 , tst loss = 0.007355 , tst err = 0.089298
epoch = 86 , trn loss = 0.000250 , trn err = 0.015804 , val loss = 0.008474 , val err = 0.090138 , tst loss = 0.008123 , tst err = 0.093844
epoch = 87 , trn loss = 0.000200 , trn err = 0.014129 , val loss = 0.007405 , val err = 0.084259 , tst loss = 0.007170 , tst err = 0.088171
epoch = 88 , trn loss = 0.000195 , trn err = 0.013954 , val loss = 0.007398 , val err = 0.084218 , tst loss = 0.007199 , tst err = 0.088350
epoch = 89 , trn loss = 0.000192 , trn err = 0.013840 , val loss = 0.007297 , val err = 0.083643 , tst loss = 0.007110 , tst err = 0.087800
epoch = 90 , trn loss = 0.000166 , trn err = 0.012874 , val loss = 0.007503 , val err = 0.084817 , tst loss = 0.006998 , tst err = 0.087108
