Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='exchange', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.001, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/exchange_Trans_bstmodel.pth', model_type='Trans', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 5274888
Length of dataset: 4492
Length of dataset: 1518
Length of dataset: 1518
epoch = 1 , trn loss = 0.140859 , trn err = 0.375153 , val loss = 0.121733 , val err = 0.341638 , tst loss = 0.127175 , tst err = 0.371327
epoch = 2 , trn loss = 0.048369 , trn err = 0.219837 , val loss = 0.101822 , val err = 0.312452 , tst loss = 0.114525 , tst err = 0.352376
epoch = 3 , trn loss = 0.019827 , trn err = 0.140749 , val loss = 0.115090 , val err = 0.332186 , tst loss = 0.126163 , tst err = 0.369847
epoch = 4 , trn loss = 0.013221 , trn err = 0.114935 , val loss = 0.126509 , val err = 0.348275 , tst loss = 0.133486 , tst err = 0.380430
epoch = 5 , trn loss = 0.010873 , trn err = 0.104231 , val loss = 0.119707 , val err = 0.338783 , tst loss = 0.133844 , tst err = 0.380940
epoch = 6 , trn loss = 0.008585 , trn err = 0.092615 , val loss = 0.081923 , val err = 0.280262 , tst loss = 0.078036 , tst err = 0.290874
epoch = 7 , trn loss = 0.006171 , trn err = 0.078526 , val loss = 0.069837 , val err = 0.258765 , tst loss = 0.059308 , tst err = 0.253579
epoch = 8 , trn loss = 0.004838 , trn err = 0.069527 , val loss = 0.056372 , val err = 0.232485 , tst loss = 0.045718 , tst err = 0.222638
epoch = 9 , trn loss = 0.003887 , trn err = 0.062318 , val loss = 0.053496 , val err = 0.226475 , tst loss = 0.048807 , tst err = 0.230036
epoch = 10 , trn loss = 0.003066 , trn err = 0.055345 , val loss = 0.060877 , val err = 0.241596 , tst loss = 0.054257 , tst err = 0.242541
epoch = 11 , trn loss = 0.002896 , trn err = 0.053790 , val loss = 0.057265 , val err = 0.234318 , tst loss = 0.052665 , tst err = 0.238955
epoch = 12 , trn loss = 0.002406 , trn err = 0.049027 , val loss = 0.051004 , val err = 0.221138 , tst loss = 0.040031 , tst err = 0.208331
epoch = 13 , trn loss = 0.002260 , trn err = 0.047517 , val loss = 0.068023 , val err = 0.255382 , tst loss = 0.050679 , tst err = 0.234406
epoch = 14 , trn loss = 0.001886 , trn err = 0.043411 , val loss = 0.064453 , val err = 0.248590 , tst loss = 0.047780 , tst err = 0.227604
epoch = 15 , trn loss = 0.001852 , trn err = 0.043013 , val loss = 0.060475 , val err = 0.240797 , tst loss = 0.041510 , tst err = 0.212145
epoch = 16 , trn loss = 0.001745 , trn err = 0.041760 , val loss = 0.065643 , val err = 0.250873 , tst loss = 0.046134 , tst err = 0.223649
epoch = 17 , trn loss = 0.001746 , trn err = 0.041764 , val loss = 0.061857 , val err = 0.243532 , tst loss = 0.042645 , tst err = 0.215026
epoch = 18 , trn loss = 0.001648 , trn err = 0.040580 , val loss = 0.058185 , val err = 0.236193 , tst loss = 0.038732 , tst err = 0.204925
epoch = 19 , trn loss = 0.001396 , trn err = 0.037344 , val loss = 0.059028 , val err = 0.237899 , tst loss = 0.038749 , tst err = 0.204967
epoch = 20 , trn loss = 0.001402 , trn err = 0.037431 , val loss = 0.059469 , val err = 0.238786 , tst loss = 0.039605 , tst err = 0.207221
epoch = 21 , trn loss = 0.001506 , trn err = 0.038787 , val loss = 0.059088 , val err = 0.238019 , tst loss = 0.038326 , tst err = 0.203847
epoch = 22 , trn loss = 0.001297 , trn err = 0.035997 , val loss = 0.060593 , val err = 0.241032 , tst loss = 0.040717 , tst err = 0.210108
epoch = 23 , trn loss = 0.001265 , trn err = 0.035554 , val loss = 0.055494 , val err = 0.230667 , tst loss = 0.036790 , tst err = 0.199721
epoch = 24 , trn loss = 0.001229 , trn err = 0.035047 , val loss = 0.063188 , val err = 0.246138 , tst loss = 0.043837 , tst err = 0.218010
epoch = 25 , trn loss = 0.001134 , trn err = 0.033655 , val loss = 0.057975 , val err = 0.235767 , tst loss = 0.040048 , tst err = 0.208374
epoch = 26 , trn loss = 0.001147 , trn err = 0.033856 , val loss = 0.052379 , val err = 0.224100 , tst loss = 0.038199 , tst err = 0.203509
epoch = 27 , trn loss = 0.001093 , trn err = 0.033053 , val loss = 0.047941 , val err = 0.214395 , tst loss = 0.033428 , tst err = 0.190375
epoch = 28 , trn loss = 0.000998 , trn err = 0.031581 , val loss = 0.052137 , val err = 0.223581 , tst loss = 0.040333 , tst err = 0.209117
epoch = 29 , trn loss = 0.001023 , trn err = 0.031964 , val loss = 0.044622 , val err = 0.206840 , tst loss = 0.033431 , tst err = 0.190384
epoch = 30 , trn loss = 0.000977 , trn err = 0.031239 , val loss = 0.040281 , val err = 0.196522 , tst loss = 0.031287 , tst err = 0.184179
epoch = 31 , trn loss = 0.001058 , trn err = 0.032520 , val loss = 0.040441 , val err = 0.196912 , tst loss = 0.030703 , tst err = 0.182453
epoch = 32 , trn loss = 0.000947 , trn err = 0.030757 , val loss = 0.043396 , val err = 0.203980 , tst loss = 0.032608 , tst err = 0.188027
epoch = 33 , trn loss = 0.000851 , trn err = 0.029157 , val loss = 0.043922 , val err = 0.205212 , tst loss = 0.033979 , tst err = 0.191937
epoch = 34 , trn loss = 0.000800 , trn err = 0.028278 , val loss = 0.041584 , val err = 0.199675 , tst loss = 0.032385 , tst err = 0.187383
epoch = 35 , trn loss = 0.000813 , trn err = 0.028507 , val loss = 0.038706 , val err = 0.192642 , tst loss = 0.031650 , tst err = 0.185244
epoch = 36 , trn loss = 0.000918 , trn err = 0.030286 , val loss = 0.038623 , val err = 0.192436 , tst loss = 0.031563 , tst err = 0.184989
epoch = 37 , trn loss = 0.000870 , trn err = 0.029482 , val loss = 0.034562 , val err = 0.182037 , tst loss = 0.028485 , tst err = 0.175736
epoch = 38 , trn loss = 0.000761 , trn err = 0.027575 , val loss = 0.033906 , val err = 0.180302 , tst loss = 0.028352 , tst err = 0.175326
epoch = 39 , trn loss = 0.000739 , trn err = 0.027164 , val loss = 0.031695 , val err = 0.174323 , tst loss = 0.024941 , tst err = 0.164443
epoch = 40 , trn loss = 0.000713 , trn err = 0.026697 , val loss = 0.031781 , val err = 0.174559 , tst loss = 0.027075 , tst err = 0.171332
epoch = 41 , trn loss = 0.000683 , trn err = 0.026131 , val loss = 0.035763 , val err = 0.185174 , tst loss = 0.030428 , tst err = 0.181633
epoch = 42 , trn loss = 0.000763 , trn err = 0.027612 , val loss = 0.034360 , val err = 0.181505 , tst loss = 0.027657 , tst err = 0.173166
epoch = 43 , trn loss = 0.000674 , trn err = 0.025956 , val loss = 0.031930 , val err = 0.174970 , tst loss = 0.027020 , tst err = 0.171158
epoch = 44 , trn loss = 0.000677 , trn err = 0.026016 , val loss = 0.034231 , val err = 0.181164 , tst loss = 0.028081 , tst err = 0.174488
epoch = 45 , trn loss = 0.000640 , trn err = 0.025280 , val loss = 0.038928 , val err = 0.193194 , tst loss = 0.034035 , tst err = 0.192096
epoch = 46 , trn loss = 0.000676 , trn err = 0.025987 , val loss = 0.036079 , val err = 0.185991 , tst loss = 0.030209 , tst err = 0.180977
epoch = 47 , trn loss = 0.000700 , trn err = 0.026445 , val loss = 0.035030 , val err = 0.183266 , tst loss = 0.029124 , tst err = 0.177699
epoch = 48 , trn loss = 0.000625 , trn err = 0.024995 , val loss = 0.032752 , val err = 0.177207 , tst loss = 0.029316 , tst err = 0.178281
epoch = 49 , trn loss = 0.000650 , trn err = 0.025484 , val loss = 0.031776 , val err = 0.174547 , tst loss = 0.029088 , tst err = 0.177588
epoch = 50 , trn loss = 0.000646 , trn err = 0.025405 , val loss = 0.034715 , val err = 0.182439 , tst loss = 0.030053 , tst err = 0.180511
epoch = 51 , trn loss = 0.000619 , trn err = 0.024877 , val loss = 0.034231 , val err = 0.181164 , tst loss = 0.030916 , tst err = 0.183084
epoch = 52 , trn loss = 0.000577 , trn err = 0.024007 , val loss = 0.033852 , val err = 0.180159 , tst loss = 0.031501 , tst err = 0.184807
epoch = 53 , trn loss = 0.000653 , trn err = 0.025540 , val loss = 0.035017 , val err = 0.183231 , tst loss = 0.032070 , tst err = 0.186469
epoch = 54 , trn loss = 0.000544 , trn err = 0.023304 , val loss = 0.037105 , val err = 0.188615 , tst loss = 0.033652 , tst err = 0.191012
epoch = 55 , trn loss = 0.000576 , trn err = 0.023991 , val loss = 0.034702 , val err = 0.182405 , tst loss = 0.031913 , tst err = 0.186012
epoch = 56 , trn loss = 0.000621 , trn err = 0.024917 , val loss = 0.036858 , val err = 0.187986 , tst loss = 0.033955 , tst err = 0.191870
epoch = 57 , trn loss = 0.000533 , trn err = 0.023072 , val loss = 0.034007 , val err = 0.180569 , tst loss = 0.032224 , tst err = 0.186915
epoch = 58 , trn loss = 0.000513 , trn err = 0.022643 , val loss = 0.034096 , val err = 0.180806 , tst loss = 0.033249 , tst err = 0.189864
epoch = 59 , trn loss = 0.000545 , trn err = 0.023339 , val loss = 0.036497 , val err = 0.187064 , tst loss = 0.033572 , tst err = 0.190784
epoch = 60 , trn loss = 0.000621 , trn err = 0.024912 , val loss = 0.033121 , val err = 0.178202 , tst loss = 0.029672 , tst err = 0.179361
epoch = 61 , trn loss = 0.000505 , trn err = 0.022468 , val loss = 0.037226 , val err = 0.188922 , tst loss = 0.035549 , tst err = 0.196324
epoch = 62 , trn loss = 0.000511 , trn err = 0.022595 , val loss = 0.039037 , val err = 0.193465 , tst loss = 0.036851 , tst err = 0.199886
epoch = 63 , trn loss = 0.000553 , trn err = 0.023498 , val loss = 0.033799 , val err = 0.180018 , tst loss = 0.034288 , tst err = 0.192808
epoch = 64 , trn loss = 0.000513 , trn err = 0.022638 , val loss = 0.032973 , val err = 0.177804 , tst loss = 0.031729 , tst err = 0.185475
