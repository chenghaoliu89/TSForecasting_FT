Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='air-quality', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.003, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/air-quality_LSTM_bstmodel.pth', model_type='LSTM', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 54349
Length of dataset: 5554
Length of dataset: 1871
Length of dataset: 1872
epoch = 1 , trn loss = 0.165043 , trn err = 0.406349 , val loss = 0.126952 , val err = 0.371082 , tst loss = 0.118150 , tst err = 0.396857
epoch = 2 , trn loss = 0.053190 , trn err = 0.230684 , val loss = 0.090722 , val err = 0.313693 , tst loss = 0.091473 , tst err = 0.349192
epoch = 3 , trn loss = 0.040395 , trn err = 0.201032 , val loss = 0.080050 , val err = 0.294666 , tst loss = 0.078114 , tst err = 0.322688
epoch = 4 , trn loss = 0.033347 , trn err = 0.182653 , val loss = 0.070606 , val err = 0.276739 , tst loss = 0.067588 , tst err = 0.300159
epoch = 5 , trn loss = 0.030621 , trn err = 0.175029 , val loss = 0.052948 , val err = 0.239648 , tst loss = 0.046219 , tst err = 0.248216
epoch = 6 , trn loss = 0.028912 , trn err = 0.170075 , val loss = 0.052312 , val err = 0.238204 , tst loss = 0.044678 , tst err = 0.244042
epoch = 7 , trn loss = 0.027768 , trn err = 0.166677 , val loss = 0.048862 , val err = 0.230216 , tst loss = 0.041443 , tst err = 0.235042
epoch = 8 , trn loss = 0.026992 , trn err = 0.164332 , val loss = 0.046626 , val err = 0.224888 , tst loss = 0.040255 , tst err = 0.231647
epoch = 9 , trn loss = 0.026023 , trn err = 0.161354 , val loss = 0.042267 , val err = 0.214115 , tst loss = 0.035529 , tst err = 0.217624
epoch = 10 , trn loss = 0.026060 , trn err = 0.161468 , val loss = 0.042798 , val err = 0.215457 , tst loss = 0.035364 , tst err = 0.217118
epoch = 11 , trn loss = 0.025024 , trn err = 0.158225 , val loss = 0.041188 , val err = 0.211366 , tst loss = 0.034170 , tst err = 0.213422
epoch = 12 , trn loss = 0.024192 , trn err = 0.155574 , val loss = 0.042681 , val err = 0.215163 , tst loss = 0.036889 , tst err = 0.221750
epoch = 13 , trn loss = 0.023480 , trn err = 0.153266 , val loss = 0.040315 , val err = 0.209113 , tst loss = 0.032520 , tst err = 0.208207
epoch = 14 , trn loss = 0.022918 , trn err = 0.151421 , val loss = 0.039682 , val err = 0.207466 , tst loss = 0.032374 , tst err = 0.207737
epoch = 15 , trn loss = 0.022615 , trn err = 0.150418 , val loss = 0.041455 , val err = 0.212050 , tst loss = 0.035186 , tst err = 0.216572
epoch = 16 , trn loss = 0.022360 , trn err = 0.149566 , val loss = 0.040931 , val err = 0.210706 , tst loss = 0.033328 , tst err = 0.210776
epoch = 17 , trn loss = 0.022249 , trn err = 0.149195 , val loss = 0.042611 , val err = 0.214986 , tst loss = 0.034473 , tst err = 0.214365
epoch = 18 , trn loss = 0.021186 , trn err = 0.145586 , val loss = 0.039704 , val err = 0.207522 , tst loss = 0.032948 , tst err = 0.209572
epoch = 19 , trn loss = 0.021417 , trn err = 0.146381 , val loss = 0.041513 , val err = 0.212198 , tst loss = 0.036010 , tst err = 0.219094
epoch = 20 , trn loss = 0.021095 , trn err = 0.145274 , val loss = 0.040138 , val err = 0.208654 , tst loss = 0.032852 , tst err = 0.209267
epoch = 21 , trn loss = 0.020621 , trn err = 0.143635 , val loss = 0.039563 , val err = 0.207153 , tst loss = 0.031253 , tst err = 0.204109
epoch = 22 , trn loss = 0.020345 , trn err = 0.142669 , val loss = 0.041720 , val err = 0.212726 , tst loss = 0.035587 , tst err = 0.217802
epoch = 23 , trn loss = 0.020455 , trn err = 0.143054 , val loss = 0.040308 , val err = 0.209097 , tst loss = 0.032904 , tst err = 0.209430
epoch = 24 , trn loss = 0.020295 , trn err = 0.142493 , val loss = 0.040558 , val err = 0.209744 , tst loss = 0.031786 , tst err = 0.205843
epoch = 25 , trn loss = 0.020570 , trn err = 0.143456 , val loss = 0.039499 , val err = 0.206987 , tst loss = 0.030050 , tst err = 0.200143
epoch = 26 , trn loss = 0.019692 , trn err = 0.140360 , val loss = 0.040960 , val err = 0.210779 , tst loss = 0.032348 , tst err = 0.207654
epoch = 27 , trn loss = 0.019942 , trn err = 0.141250 , val loss = 0.038315 , val err = 0.203860 , tst loss = 0.030685 , tst err = 0.202244
epoch = 28 , trn loss = 0.019584 , trn err = 0.139976 , val loss = 0.044547 , val err = 0.219814 , tst loss = 0.036555 , tst err = 0.220746
epoch = 29 , trn loss = 0.019522 , trn err = 0.139753 , val loss = 0.039927 , val err = 0.208104 , tst loss = 0.030537 , tst err = 0.201757
epoch = 30 , trn loss = 0.018963 , trn err = 0.137739 , val loss = 0.044016 , val err = 0.218502 , tst loss = 0.034889 , tst err = 0.215654
epoch = 31 , trn loss = 0.019630 , trn err = 0.140140 , val loss = 0.040208 , val err = 0.208835 , tst loss = 0.031306 , tst err = 0.204283
epoch = 32 , trn loss = 0.018959 , trn err = 0.137725 , val loss = 0.038872 , val err = 0.205338 , tst loss = 0.034096 , tst err = 0.213192
epoch = 33 , trn loss = 0.018750 , trn err = 0.136963 , val loss = 0.042033 , val err = 0.213522 , tst loss = 0.034912 , tst err = 0.215726
epoch = 34 , trn loss = 0.018471 , trn err = 0.135939 , val loss = 0.040507 , val err = 0.209612 , tst loss = 0.033353 , tst err = 0.210855
epoch = 35 , trn loss = 0.018160 , trn err = 0.134792 , val loss = 0.041117 , val err = 0.211184 , tst loss = 0.033493 , tst err = 0.211298
epoch = 36 , trn loss = 0.018129 , trn err = 0.134674 , val loss = 0.042727 , val err = 0.215279 , tst loss = 0.034308 , tst err = 0.213852
epoch = 37 , trn loss = 0.018124 , trn err = 0.134658 , val loss = 0.041215 , val err = 0.211434 , tst loss = 0.032486 , tst err = 0.208095
epoch = 38 , trn loss = 0.017759 , trn err = 0.133293 , val loss = 0.043744 , val err = 0.217825 , tst loss = 0.035254 , tst err = 0.216780
epoch = 39 , trn loss = 0.017945 , trn err = 0.133989 , val loss = 0.043842 , val err = 0.218069 , tst loss = 0.036377 , tst err = 0.220208
epoch = 40 , trn loss = 0.017495 , trn err = 0.132298 , val loss = 0.043303 , val err = 0.216724 , tst loss = 0.036217 , tst err = 0.219723
epoch = 41 , trn loss = 0.017312 , trn err = 0.131605 , val loss = 0.041242 , val err = 0.211504 , tst loss = 0.032892 , tst err = 0.209393
epoch = 42 , trn loss = 0.017219 , trn err = 0.131252 , val loss = 0.043869 , val err = 0.218137 , tst loss = 0.036838 , tst err = 0.221599
epoch = 43 , trn loss = 0.017242 , trn err = 0.131341 , val loss = 0.042737 , val err = 0.215304 , tst loss = 0.033276 , tst err = 0.210612
epoch = 44 , trn loss = 0.017245 , trn err = 0.131352 , val loss = 0.042938 , val err = 0.215810 , tst loss = 0.036674 , tst err = 0.221103
epoch = 45 , trn loss = 0.017097 , trn err = 0.130786 , val loss = 0.045536 , val err = 0.222241 , tst loss = 0.037246 , tst err = 0.222820
epoch = 46 , trn loss = 0.017396 , trn err = 0.131926 , val loss = 0.043660 , val err = 0.217616 , tst loss = 0.036658 , tst err = 0.221055
epoch = 47 , trn loss = 0.016826 , trn err = 0.129745 , val loss = 0.046392 , val err = 0.224321 , tst loss = 0.040309 , tst err = 0.231801
epoch = 48 , trn loss = 0.016333 , trn err = 0.127829 , val loss = 0.045596 , val err = 0.222389 , tst loss = 0.040558 , tst err = 0.232518
epoch = 49 , trn loss = 0.016598 , trn err = 0.128863 , val loss = 0.045143 , val err = 0.221280 , tst loss = 0.037100 , tst err = 0.222383
epoch = 50 , trn loss = 0.016737 , trn err = 0.129401 , val loss = 0.045103 , val err = 0.221183 , tst loss = 0.038153 , tst err = 0.225519
epoch = 51 , trn loss = 0.016771 , trn err = 0.129531 , val loss = 0.045031 , val err = 0.221006 , tst loss = 0.037698 , tst err = 0.224169
epoch = 52 , trn loss = 0.016463 , trn err = 0.128338 , val loss = 0.045544 , val err = 0.222262 , tst loss = 0.037346 , tst err = 0.223122
