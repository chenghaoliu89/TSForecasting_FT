Namespace(agcrn_embed_dim=10, agcrn_hidden_size=64, agcrn_n_layers=1, bad_limit=25, batch_size=64, data_dir='data/forecasting', dataset='air-quality', device='cuda', dsanet_d_inner=2048, dsanet_d_k=64, dsanet_d_model=512, dsanet_d_v=64, dsanet_dropout=0.1, dsanet_local=3, dsanet_n_head=8, dsanet_n_kernels=32, dsanet_n_layers=1, dsanet_w_kernel=1, fine_tuning=False, horizon=1, lmbd=0.0, local_norm=False, lr=0.001, lstm_hidden_size=64, lstm_n_layers=2, model_decay_rate=1, model_loadpath='outputs/forecasting/air-quality_Trans_bstmodel.pth', model_type='Trans', n_epochs=750, n_series=None, norm_type='standard', output_dir='outputs/forecasting', series_len=60, task_type='forecasting', tcn_dropout=0, tcn_hidden_size=64, tcn_n_layers=9, test_ratio=0.2, tpa_ar_len=24, tpa_hidden_size=64, tpa_n_layers=1, trans_hidden_size=256, trans_kernel_size=6, trans_n_head=8, trans_n_layers=3, valid_ratio=0.2)
total num of parameters: 5283853
Length of dataset: 5554
Length of dataset: 1871
Length of dataset: 1872
epoch = 1 , trn loss = 0.211814 , trn err = 0.460339 , val loss = 0.212270 , val err = 0.479836 , tst loss = 0.214748 , tst err = 0.535034
epoch = 2 , trn loss = 0.111614 , trn err = 0.334164 , val loss = 0.127255 , val err = 0.371524 , tst loss = 0.131682 , tst err = 0.418967
epoch = 3 , trn loss = 0.063288 , trn err = 0.251629 , val loss = 0.090802 , val err = 0.313832 , tst loss = 0.095395 , tst err = 0.356598
epoch = 4 , trn loss = 0.045095 , trn err = 0.212406 , val loss = 0.063609 , val err = 0.262669 , tst loss = 0.064006 , tst err = 0.292096
epoch = 5 , trn loss = 0.036543 , trn err = 0.191208 , val loss = 0.049307 , val err = 0.231261 , tst loss = 0.042982 , tst err = 0.239363
epoch = 6 , trn loss = 0.031246 , trn err = 0.176808 , val loss = 0.049694 , val err = 0.232167 , tst loss = 0.045790 , tst err = 0.247060
epoch = 7 , trn loss = 0.029127 , trn err = 0.170706 , val loss = 0.040905 , val err = 0.210638 , tst loss = 0.035951 , tst err = 0.218912
epoch = 8 , trn loss = 0.029086 , trn err = 0.170586 , val loss = 0.045380 , val err = 0.221860 , tst loss = 0.037470 , tst err = 0.223490
epoch = 9 , trn loss = 0.026462 , trn err = 0.162709 , val loss = 0.040215 , val err = 0.208854 , tst loss = 0.035959 , tst err = 0.218937
epoch = 10 , trn loss = 0.026312 , trn err = 0.162248 , val loss = 0.043667 , val err = 0.217633 , tst loss = 0.033027 , tst err = 0.209821
epoch = 11 , trn loss = 0.025684 , trn err = 0.160298 , val loss = 0.042552 , val err = 0.214838 , tst loss = 0.035776 , tst err = 0.218379
epoch = 12 , trn loss = 0.024511 , trn err = 0.156596 , val loss = 0.040519 , val err = 0.209642 , tst loss = 0.036398 , tst err = 0.220270
epoch = 13 , trn loss = 0.023974 , trn err = 0.154872 , val loss = 0.042231 , val err = 0.214026 , tst loss = 0.041453 , tst err = 0.235068
epoch = 14 , trn loss = 0.024415 , trn err = 0.156289 , val loss = 0.042432 , val err = 0.214533 , tst loss = 0.034902 , tst err = 0.215697
epoch = 15 , trn loss = 0.024236 , trn err = 0.155716 , val loss = 0.055868 , val err = 0.246167 , tst loss = 0.050264 , tst err = 0.258849
epoch = 16 , trn loss = 0.023258 , trn err = 0.152540 , val loss = 0.045454 , val err = 0.222043 , tst loss = 0.036341 , tst err = 0.220098
epoch = 17 , trn loss = 0.022925 , trn err = 0.151445 , val loss = 0.040331 , val err = 0.209155 , tst loss = 0.030482 , tst err = 0.201575
epoch = 18 , trn loss = 0.033109 , trn err = 0.182000 , val loss = 0.080162 , val err = 0.294872 , tst loss = 0.071585 , tst err = 0.308908
epoch = 19 , trn loss = 0.041062 , trn err = 0.202686 , val loss = 0.042525 , val err = 0.214769 , tst loss = 0.042499 , tst err = 0.238015
epoch = 20 , trn loss = 0.026700 , trn err = 0.163439 , val loss = 0.045665 , val err = 0.222556 , tst loss = 0.047558 , tst err = 0.251785
epoch = 21 , trn loss = 0.025005 , trn err = 0.158165 , val loss = 0.050109 , val err = 0.233135 , tst loss = 0.047454 , tst err = 0.251509
epoch = 22 , trn loss = 0.023209 , trn err = 0.152381 , val loss = 0.056091 , val err = 0.246659 , tst loss = 0.046076 , tst err = 0.247830
epoch = 23 , trn loss = 0.030127 , trn err = 0.173613 , val loss = 0.053463 , val err = 0.240812 , tst loss = 0.055382 , tst err = 0.271708
epoch = 24 , trn loss = 0.027505 , trn err = 0.165886 , val loss = 0.049548 , val err = 0.231827 , tst loss = 0.050257 , tst err = 0.258831
epoch = 25 , trn loss = 0.024871 , trn err = 0.157742 , val loss = 0.048268 , val err = 0.228811 , tst loss = 0.048945 , tst err = 0.255430
epoch = 26 , trn loss = 0.023622 , trn err = 0.153730 , val loss = 0.056379 , val err = 0.247291 , tst loss = 0.061387 , tst err = 0.286058
epoch = 27 , trn loss = 0.024002 , trn err = 0.154961 , val loss = 0.066597 , val err = 0.268768 , tst loss = 0.041794 , tst err = 0.236034
epoch = 28 , trn loss = 0.024188 , trn err = 0.155562 , val loss = 0.056437 , val err = 0.247417 , tst loss = 0.054231 , tst err = 0.268868
epoch = 29 , trn loss = 0.023355 , trn err = 0.152860 , val loss = 0.052848 , val err = 0.239422 , tst loss = 0.048546 , tst err = 0.254386
epoch = 30 , trn loss = 0.024230 , trn err = 0.155696 , val loss = 0.062487 , val err = 0.260341 , tst loss = 0.069800 , tst err = 0.305031
epoch = 31 , trn loss = 0.028137 , trn err = 0.167779 , val loss = 0.060300 , val err = 0.255746 , tst loss = 0.044047 , tst err = 0.242312
epoch = 32 , trn loss = 0.032214 , trn err = 0.179525 , val loss = 0.062133 , val err = 0.259603 , tst loss = 0.064784 , tst err = 0.293867
epoch = 33 , trn loss = 0.030421 , trn err = 0.174458 , val loss = 0.067438 , val err = 0.270458 , tst loss = 0.073265 , tst err = 0.312510
epoch = 34 , trn loss = 0.037189 , trn err = 0.192889 , val loss = 0.070118 , val err = 0.275780 , tst loss = 0.072663 , tst err = 0.311224
